# Basketball Scraper

××¢×¨×›×ª ×œ×’×–×™×¨×ª × ×ª×•× ×™ ×›×“×•×¨×¡×œ
```
basketball_scraper/
â”œâ”€â”€ config.py                    # ×”×’×“×¨×•×ª ×œ×™×’×•×ª
â”œâ”€â”€ main.py                      # ×¡×§×¨×™×¤×˜ ×¨××©×™
â”œâ”€â”€ models/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ data_models.py          # ×™×¦×™×¨×ª IDs ×•××‘× ×™ × ×ª×•× ×™×
â”œâ”€â”€ scrapers/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ ibasketball.py          # ×’×–×™×¨×” ×-ibasketball.co.il
â”œâ”€â”€ utils/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ helpers.py              # ×¤×•× ×§×¦×™×•×ª ×¢×–×¨
â”œâ”€â”€ data/                        # × ×ª×•× ×™× (× ×•×¦×¨ ××•×˜×•××˜×™×ª)
â”‚   â”œâ”€â”€ normalization/          # â­ ×§×‘×¦×™ normalization ×’×œ×•×‘×œ×™×™×
â”‚   â”‚   â”œâ”€â”€ teams_mapping.csv   # ××™×¤×•×™ ×›×œ ×”×§×‘×•×¦×•×ª
â”‚   â”‚   â””â”€â”€ leagues_mapping.csv # ××™×¤×•×™ ×œ×™×’×•×ª (××•×¤×¦×™×•× ×œ×™)
â”‚   â”œâ”€â”€ leagues.csv             # ×›×œ ×”×œ×™×’×•×ª
â”‚   â”œâ”€â”€ teams.csv               # ×›×œ ×”×§×‘×•×¦×•×ª
â”‚   â”œâ”€â”€ players.csv             # ×›×œ ×”×©×—×§× ×™×
â”‚   â”œâ”€â”€ leumit/                 # × ×ª×•× ×™× ×œ×œ×™×’×” ×œ××•××™×ª
â”‚   â”‚   â”œâ”€â”€ leumit_player_details.csv
â”‚   â”‚   â”œâ”€â”€ leumit_player_history.csv
â”‚   â”‚   â”œâ”€â”€ leumit_player_averages.csv
â”‚   â”‚   â”œâ”€â”€ leumit_team_averages.csv
â”‚   â”‚   â”œâ”€â”€ leumit_opponent_averages.csv
â”‚   â”‚   â””â”€â”€ leumit_games/
â”‚   â”‚       â”œâ”€â”€ games_schedule.csv
â”‚   â”‚       â”œâ”€â”€ game_quarters.csv
â”‚   â”‚       â”œâ”€â”€ game_player_stats.csv
â”‚   â”‚       â””â”€â”€ game_team_stats.csv
â”‚   â””â”€â”€ artzit/                 # × ×ª×•× ×™× ×œ×œ×™×’×” ××¨×¦×™×ª
â”‚       â””â”€â”€ ...
â””â”€â”€ logs/                        # ×§×‘×¦×™ ×œ×•×’
    â””â”€â”€ update_log.txt
```# ğŸ€ Basketball Scraper - ××¢×¨×›×ª ×’×–×™×¨×” ××§×¦×•×¢×™×ª

××¢×¨×›×ª ××•×“×•×œ×¨×™×ª ×œ×’×–×™×¨×” ××•×˜×•××˜×™×ª ×©×œ × ×ª×•× ×™ ×›×“×•×¨×¡×œ ××œ×™×’×•×ª ××¨×•×‘×•×ª.

---

## ğŸ“ ××‘× ×” ×”×¤×¨×•×™×§×˜

```
basketball_scraper/
â”œâ”€â”€ config.py                    # ×”×’×“×¨×•×ª ×œ×™×’×•×ª
â”œâ”€â”€ main.py                      # ×¡×§×¨×™×¤×˜ ×¨××©×™
â”œâ”€â”€ models/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ data_models.py          # ×™×¦×™×¨×ª IDs ×•××‘× ×™ × ×ª×•× ×™×
â”œâ”€â”€ scrapers/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ ibasketball.py          # ×’×–×™×¨×” ×-ibasketball.co.il
â”œâ”€â”€ utils/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ helpers.py              # ×¤×•× ×§×¦×™×•×ª ×¢×–×¨
â”œâ”€â”€ data/                        # × ×ª×•× ×™× (× ×•×¦×¨ ××•×˜×•××˜×™×ª)
â”‚   â”œâ”€â”€ leagues.csv             # ×›×œ ×”×œ×™×’×•×ª
â”‚   â”œâ”€â”€ teams.csv               # ×›×œ ×”×§×‘×•×¦×•×ª
â”‚   â”œâ”€â”€ players.csv             # ×›×œ ×”×©×—×§× ×™×
â”‚   â”œâ”€â”€ leumit/                 # × ×ª×•× ×™× ×œ×œ×™×’×” ×œ××•××™×ª
â”‚   â”‚   â”œâ”€â”€ team_names.csv
â”‚   â”‚   â”œâ”€â”€ leumit_player_details.csv
â”‚   â”‚   â”œâ”€â”€ leumit_player_history.csv
â”‚   â”‚   â”œâ”€â”€ leumit_player_averages.csv
â”‚   â”‚   â”œâ”€â”€ leumit_team_averages.csv
â”‚   â”‚   â”œâ”€â”€ leumit_opponent_averages.csv
â”‚   â”‚   â””â”€â”€ leumit_games/
â”‚   â”‚       â”œâ”€â”€ games_schedule.csv
â”‚   â”‚       â”œâ”€â”€ game_quarters.csv
â”‚   â”‚       â”œâ”€â”€ game_player_stats.csv
â”‚   â”‚       â””â”€â”€ game_team_stats.csv
â”‚   â””â”€â”€ artzit/                 # × ×ª×•× ×™× ×œ×œ×™×’×” ××¨×¦×™×ª
â”‚       â””â”€â”€ ...
â””â”€â”€ logs/                        # ×§×‘×¦×™ ×œ×•×’
    â””â”€â”€ update_log.txt
```

---

## ğŸš€ ×”×ª×§× ×” ××”×™×¨×”

### 1. ×“×¨×™×©×•×ª ××§×“×™××•×ª

×•×•×“× ×©×™×© ×œ×š Python 3.7+ ××•×ª×§×Ÿ:

```bash
python --version
```

### 2. ×”×ª×§× ×ª ×¡×¤×¨×™×•×ª

```bash
pip install requests beautifulsoup4 pandas openpyxl
```

### 3. ×”×›× ×ª ×”××‘× ×”

×¦×•×¨ ××ª ××‘× ×” ×”×ª×™×§×™×•×ª:

```bash
mkdir -p basketball_scraper/{models,scrapers,utils,data/normalization,logs}
cd basketball_scraper
```

×”×¢×ª×§ ××ª ×›×œ ×”×§×‘×¦×™× ×œ×ª×™×§×™×•×ª ×”××ª××™××•×ª:
- `config.py` â†’ ×©×•×¨×©
- `main.py` â†’ ×©×•×¨×©
- `models/__init__.py` ×•-`models/data_models.py` â†’ ×ª×™×§×™×™×ª models
- `scrapers/__init__.py` ×•-`scrapers/ibasketball.py` â†’ ×ª×™×§×™×™×ª scrapers
- `utils/__init__.py` ×•-`utils/helpers.py` â†’ ×ª×™×§×™×™×ª utils

### 4. ×”×›× ×ª ×§×•×‘×¥ ×”××™×¤×•×™ ×”×’×œ×•×‘×œ×™ â­ ×—×©×•×‘!

×¦×•×¨ `data/normalization/teams_mapping.csv` ×¢× ×›×œ ×”×§×‘×•×¦×•×ª ××›×œ ×”×œ×™×’×•×ª:

**××‘× ×” ×”×§×•×‘×¥:**
```csv
source_name,league_id,normalized_name,short_name,bg_color,text_color
××›×‘×™ ×ª×œ ××‘×™×‘ ×’×™× × ×ª×Ÿ,leumit,××›×‘×™ ×ª×œ ××‘×™×‘,××›×‘×™ ×ª"×,#0000FF,#FFFF00
××›×‘×™ ×ª"×,leumit,××›×‘×™ ×ª×œ ××‘×™×‘,××›×‘×™ ×ª"×,#0000FF,#FFFF00
××›×‘×™ ×ª×œ-××‘×™×‘,leumit,××›×‘×™ ×ª×œ ××‘×™×‘,××›×‘×™ ×ª"×,#0000FF,#FFFF00
×”×¤×•×¢×œ ×™×¨×•×©×œ×™×,leumit,×”×¤×•×¢×œ ×™×¨×•×©×œ×™×,×”×¤×•×¢×œ ×™-×,#FF0000,#FFFFFF
×”×¤×•×¢×œ ×™-×,leumit,×”×¤×•×¢×œ ×™×¨×•×©×œ×™×,×”×¤×•×¢×œ ×™-×,#FF0000,#FFFFFF
××›×‘×™ ×—×™×¤×”,artzit,××›×‘×™ ×—×™×¤×”,××›×‘×™ ×—×™×¤×”,#00AA00,#FFFFFF
```

**×”×¡×‘×¨ ×¢×œ ×”×¢××•×“×•×ª:**
- `source_name` - ×›×œ ×•×¨×™××¦×™×” ×©×œ ×”×©× ×›×¤×™ ×©××•×¤×™×¢×” ×‘××ª×¨ (××¤×©×¨ ×›××” ×©×•×¨×•×ª ×œ××•×ª×” ×§×‘×•×¦×”!)
- `league_id` - ××–×”×” ×”×œ×™×’×” (leumit, artzit, ×•×›×•')
- `normalized_name` - ×”×©× ×”××—×™×“ ×•×”×¡×˜× ×“×¨×˜×™ ×©×ª×¨×¦×” ×œ×”×©×ª××© ×‘×•
- `short_name` - ×©× ×§×¦×¨ ×œ×ª×¦×•×’×”
- `bg_color` - ×¦×‘×¢ ×¨×§×¢ ×©×œ ×”×§×‘×•×¦×” (hex color)
- `text_color` - ×¦×‘×¢ ×˜×§×¡×˜ (hex color)

**×˜×™×¤ ×—×©×•×‘:** ×× ××ª×” ×¨×•××” ×§×‘×•×¦×” ×¢× ×©××•×ª ×©×•× ×™× ×‘××ª×¨ (×œ××©×œ "××›×‘×™ ×ª"×" ×•"××›×‘×™ ×ª×œ ××‘×™×‘ ×’×™× × ×ª×Ÿ"), ×”×•×¡×£ ×©×•×¨×” × ×¤×¨×“×ª ×œ×›×œ ×•×¨×™××¦×™×”, ××‘×œ ×¢× ××•×ª×• `normalized_name`!

---

## ğŸ’» ×©×™××•×©

### ×’×–×™×¨×” ×‘×¡×™×¡×™×ª

**×’×–×™×¨×” ×©×œ ×›×œ ×”×œ×™×’×•×ª ×”×¤×¢×™×œ×•×ª:**
```bash
python main.py
```

**×’×–×™×¨×” ×©×œ ×œ×™×’×” ×¡×¤×¦×™×¤×™×ª:**
```bash
python main.py --league leumit
```

**×”×¦×’×ª ×¨×©×™××ª ×œ×™×’×•×ª ×–××™× ×•×ª:**
```bash
python main.py --list
```

### ×¤×œ×˜ ×œ×“×•×’××”

```
[2024-10-11 14:30:00] ============================================================
[2024-10-11 14:30:00] BASKETBALL SCRAPER STARTED
[2024-10-11 14:30:00] ============================================================
[2024-10-11 14:30:00] Found 2 active leagues
[2024-10-11 14:30:00] ============================================================
[2024-10-11 14:30:00] [LEUMIT] STARTING SCRAPE: ×œ×™×’×” ×œ××•××™×ª
[2024-10-11 14:30:00] ============================================================
[2024-10-11 14:30:01] [LEUMIT] âœ… Loaded team mapping: 12 teams, 36 variations
[2024-10-11 14:30:02] [LEUMIT] STEP 1: UPDATING PLAYER DETAILS
[2024-10-11 14:30:02] [LEUMIT] Found 156 players
[2024-10-11 14:30:15] [LEUMIT] âœ… Player details updated
[2024-10-11 14:30:15] [LEUMIT]    Total: 156 | New: 5 | Updated: 3 | Skipped: 148
[2024-10-11 14:30:15] [LEUMIT] STEP 2: UPDATING GAME DETAILS
[2024-10-11 14:30:16] [LEUMIT] âœ… Games schedule updated: 132 games
[2024-10-11 14:30:16] [LEUMIT]    Found 45 completed games
[2024-10-11 14:30:16] [LEUMIT]    Already scraped: 42 games
[2024-10-11 14:30:16] [LEUMIT]    Scraping 3 new games
[2024-10-11 14:30:25] [LEUMIT] âœ… Game stats updated: 3 new games
[2024-10-11 14:30:25] [LEUMIT] STEP 3: CALCULATING AVERAGES
[2024-10-11 14:30:26] [LEUMIT] âœ… Player averages calculated: 145 players
[2024-10-11 14:30:26] [LEUMIT] âœ… Team averages calculated: 12 teams
[2024-10-11 14:30:26] [LEUMIT] âœ… Opponent averages calculated: 12 teams
[2024-10-11 14:30:26] ============================================================
[2024-10-11 14:30:26] âœ… ALL UPDATES COMPLETED SUCCESSFULLY
[2024-10-11 14:30:26] ============================================================
```

---

## âš™ï¸ ×”×•×¡×¤×ª ×œ×™×’×” ×—×“×©×”

### ×©×œ×‘ 1: ×¢×“×›×•×Ÿ `config.py`

×”×•×¡×£ entry ×—×“×© ×œ-`LEAGUES`:

```python
"super_league": {
    "name": "×¡×•×¤×¨×œ×™×’",
    "name_en": "Super League",
    "country": "Israel",
    "season": "2024-25",
    "url": "https://ibasketball.co.il/league/XXXX/",  # URL ×××™×ª×™
    "data_folder": "data/super_league",
    "games_folder": "data/super_league/super_league_games",
    "active": True
}
```

### ×©×œ×‘ 2: ×”×•×¡×¤×ª ×§×‘×•×¦×•×ª ×œ-teams_mapping.csv

×”×•×¡×£ ××ª ×”×§×‘×•×¦×•×ª ×©×œ ×”×œ×™×’×” ×”×—×“×©×” ×œ-`data/normalization/teams_mapping.csv`:

```csv
source_name,league_id,normalized_name,short_name,bg_color,text_color
×§×‘×•×¦×” ×,super_league,×§×‘×•×¦×” ×,×§×‘×•×¦×” ×,#FF0000,#FFFFFF
×§×‘×•×¦×” ×‘,super_league,×§×‘×•×¦×” ×‘,×§×‘×•×¦×” ×‘,#00FF00,#000000
```

### ×©×œ×‘ 3: ×”×¨×¦×”

```bash
python main.py --league super_league
```

**×–×”×•! ×”×œ×™×’×” ×”×—×“×©×” ××•×›× ×”** âœ…

**×™×ª×¨×•×Ÿ ×”××‘× ×” ×”×—×“×©:**
- ×§×•×‘×¥ ××—×“ ×œ×›×œ ×”×§×‘×•×¦×•×ª ××›×œ ×”×œ×™×’×•×ª
- ×§×œ ×œ×”×•×¡×™×£ ×œ×™×’×” ×—×“×©×” - ×¨×§ 2 ××§×•××•×ª ×œ×¢×“×›×Ÿ (config.py + teams_mapping.csv)
- ××™×Ÿ ×¦×•×¨×š ×œ×™×¦×•×¨ ×§×‘×¦×™× × ×¤×¨×“×™× ×œ×›×œ ×œ×™×’×”

---

## ğŸ”„ ×”×¨×¦×” ××•×˜×•××˜×™×ª ×™×•××™×ª

### Linux/Mac (cron)

```bash
crontab -e
```

×”×•×¡×£:
```
0 2 * * * cd /path/to/basketball_scraper && /usr/bin/python3 main.py
```
(×™×¨×•×¥ ×›×œ ×™×•× ×‘×©×¢×” 02:00)

### Windows (Task Scheduler)

1. ×¤×ª×— **Task Scheduler**
2. ×¦×•×¨ **New Task**
3. **Trigger**: Daily, 02:00 AM
4. **Action**: Start a program
   - Program: `python`
   - Arguments: `main.py`
   - Start in: `C:\path\to\basketball_scraper`

---

## ğŸ“Š ×”× ×ª×•× ×™× ×©× ×•×¦×¨×™×

### ×§×‘×¦×™× ×’×œ×•×‘×œ×™×™× (×›×œ ×”×œ×™×’×•×ª ×‘×™×—×“)

| ×§×•×‘×¥ | ×ª×™××•×¨ |
|------|-------|
| `data/leagues.csv` | ×¨×©×™××ª ×›×œ ×”×œ×™×’×•×ª |
| `data/teams.csv` | ×›×œ ×”×§×‘×•×¦×•×ª ××›×œ ×”×œ×™×’×•×ª |
| `data/players.csv` | ×›×œ ×”×©×—×§× ×™× ××›×œ ×”×œ×™×’×•×ª |

### ×§×‘×¦×™× ×œ×¤×™ ×œ×™×’×”

| ×§×•×‘×¥ | ×ª×™××•×¨ |
|------|-------|
| `[league]_player_details.csv` | ×¤×¨×˜×™ ×©×—×§× ×™× ×‘×¡×™×¡×™×™× |
| `[league]_player_history.csv` | ×”×™×¡×˜×•×¨×™×™×ª ×§×‘×•×¦×•×ª ×œ×¤×™ ×¢×•× ×•×ª |
| `[league]_player_averages.csv` | ×××•×¦×¢×™ ×©×—×§× ×™× ×œ×¢×•× ×” |
| `[league]_team_averages.csv` | ×××•×¦×¢×™ ×§×‘×•×¦×•×ª ×œ×¢×•× ×” |
| `[league]_opponent_averages.csv` | ×××•×¦×¢×™ ×™×¨×™×‘×™× (×”×’× ×”) |
| `games_schedule.csv` | ×œ×•×— ××©×—×§×™× ××œ× |
| `game_quarters.csv` | × ×™×§×•×“ ×œ×¤×™ ×¨×‘×¢×™× |
| `game_player_stats.csv` | ×¡×˜×˜×™×¡×˜×™×§×•×ª ×©×—×§× ×™× ×œ××©×—×§ |
| `game_team_stats.csv` | ×¡×˜×˜×™×¡×˜×™×§×•×ª ×§×‘×•×¦×ª×™×•×ª ×œ××©×—×§ |

---

## ğŸ†” ××–×”×™× ×™×™×—×•×“×™×™× (IDs)

×”××¢×¨×›×ª ×™×•×¦×¨×ª IDs ×™×™×—×•×“×™×™× ×œ×›×œ ×™×©×•×ª:

### Player ID
```python
player_id = hash(×©×_×©×—×§×Ÿ + ×ª××¨×™×š_×œ×™×“×”)
# ×“×•×’××”: "a3f5b8c2d1e4"
```

### Team ID
```python
team_id = hash(league_id + ×©×_×§×‘×•×¦×”_×× ×•×¨××œ)
# ×“×•×’××”: "b2c4d6e8f0a1"
```

### Game ID
```python
game_id = f"{league_id}_{game_code}"
# ×“×•×’××”: "leumit_12345"
```

**×™×ª×¨×•×Ÿ:** ××™×Ÿ ×‘×¢×™×•×ª ×©×œ ×©××•×ª ×–×”×™× ××• ×©×™× ×•×™×™ ×©××•×ª!

---

## ğŸ”§ ×¤×ª×¨×•×Ÿ ×‘×¢×™×•×ª

### ×©×’×™××”: "No module named 'models'"

**×¤×ª×¨×•×Ÿ:** ×•×•×“× ×©×™×© ×§×•×‘×¥ `__init__.py` ×‘×ª×™×§×™×•×ª:
```bash
touch models/__init__.py
touch scrapers/__init__.py
touch utils/__init__.py
```

### ×©×’×™××”: "Team mapping file not found"

**×¤×ª×¨×•×Ÿ:** ×¦×•×¨ `data/[league_id]/team_names.csv` ×œ×¤× ×™ ×”×¨×¦×”.

### ×©×’×™××”: "Could not find league_id"

**×¤×ª×¨×•×Ÿ:** ×‘×“×•×§ ×©×”-URL ×‘config.py × ×›×•×Ÿ ×•×©×™×© ×§×™×©×•×¨ "export" ×‘××ª×¨ ×”×œ×™×’×”.

### ×œ× × ×•×¦×¨×™× ×§×‘×¦×™ × ×ª×•× ×™×

**×¤×ª×¨×•×Ÿ:** ×”×¨×¥ ×¢× `--league [league_id]` ×œ×œ×™×’×” ×¡×¤×¦×™×¤×™×ª ×•×¦×¤×” ×‘×©×’×™××•×ª.

---

## ğŸ“ ×œ×•×’×™×

×›×œ ×”×¤×¢×•×œ×•×ª × ×¨×©××•×ª ×‘-`logs/update_log.txt`:

```bash
tail -f logs/update_log.txt  # ×¦×¤×™×™×” ×‘×–××Ÿ ×××ª
```

---

## ğŸ¯ ××” ×”×œ××”?

### ××™× ×˜×’×¨×¦×™×” ×¢× Base44

×”× ×ª×•× ×™× ××•×›× ×™× ×œ×”×¢×œ××” ×œ-Base44:
1. ×”×¢×œ×” ××ª ×”×§×‘×¦×™× ×-`data/` ×œ-Base44
2. ×¦×•×¨ ××ª ×”×˜×‘×œ××•×ª ×”××ª××™××•×ª
3. ×§×™×©×•×¨ ×”× ×ª×•× ×™× ×‘×™×Ÿ ×”×˜×‘×œ××•×ª ×“×¨×š ×”-IDs

### ××¢×‘×¨ ×œ-Supabase (×¢×ª×™×“×™)

×›×©×ª×”×™×™× ×” ×™×•×ª×¨ ×œ×™×’×•×ª:
1. ×”×§× Supabase project
2. ×¦×•×¨ ××ª ×”×˜×‘×œ××•×ª
3. ×©× ×” ××ª `save_to_csv()` ×‘-`helpers.py` ×œ×©××•×¨ ×™×©×™×¨×•×ª ×œ-DB

---

## ğŸ’¡ ×˜×™×¤×™×

- **×ª×“×™×¨×•×ª ×’×–×™×¨×”:** ×”×¨×¥ ×¤×¢× ×‘×™×•× ××¡×¤×™×§ (××©×—×§×™× ×—×“×©×™×)
- **×‘×™×¦×•×¢×™×:** ×”×¡×§×¨×™×¤×˜ ×—×›× ×•×“×•×œ×’ ×¢×œ × ×ª×•× ×™× ×§×™×™××™×
- **×œ×™×’×•×ª ×¨×‘×•×ª:** ×”×•×¡×£/×”×¡×¨ ×œ×™×’×•×ª ×‘×§×œ×•×ª ×“×¨×š `config.py`
- **×’×™×‘×•×™:** ×©××•×¨ ××ª ×ª×™×§×™×™×ª `data/` ×‘××•×¤×Ÿ ×§×‘×•×¢

---

## ğŸ¤ ×ª××™×›×”

×™×© ×©××œ×”? ×‘×“×•×§ ××ª:
1. ×§×‘×¦×™ ×”×œ×•×’ ×‘-`logs/update_log.txt`
2. ×”×¤×œ×˜ ×‘×§×•× ×¡×•×œ ×‘×–××Ÿ ×”×¨×¦×”
3. ×”××“×¨×™×š ×”×–×”

---

**× ×•×¦×¨ ×¢× â¤ï¸ ×œ× ×™×”×•×œ × ×ª×•× ×™ ×›×“×•×¨×¡×œ ××§×¦×•×¢×™**