-- WARNING: This schema is for context only and is not meant to be run.
-- Table order and constraints may not be valid for execution.

CREATE TABLE public.game_player_stats (
  game_id text NOT NULL,
  player_id text NOT NULL,
  league_id integer NOT NULL,
  player_name text,
  team text,
  team_id integer,
  opponent text,
  game_date date,
  min integer,
  pts integer,
  fgm integer,
  fga integer,
  fg_pct numeric,
  2ptm integer,
  2pta integer,
  2pt_pct numeric,
  3ptm integer,
  3pta integer,
  3pt_pct numeric,
  ftm integer,
  fta integer,
  ft_pct numeric,
  def integer,
  off integer,
  reb integer,
  ast integer,
  stl integer,
  to integer,
  pf integer,
  pfa integer,
  blk integer,
  blka integer,
  rate numeric,
  starter integer DEFAULT 0,
  number integer,
  created_at timestamp with time zone DEFAULT now(),
  updated_at timestamp with time zone DEFAULT now(),
  CONSTRAINT game_player_stats_pkey PRIMARY KEY (game_id, player_id),
  CONSTRAINT game_player_stats_game_id_fkey FOREIGN KEY (game_id) REFERENCES public.games(game_id),
  CONSTRAINT game_player_stats_player_id_fkey FOREIGN KEY (player_id) REFERENCES public.players(player_id),
  CONSTRAINT game_player_stats_league_id_fkey FOREIGN KEY (league_id) REFERENCES public.leagues(league_id),
  CONSTRAINT game_player_stats_team_id_league_id_fkey FOREIGN KEY (league_id) REFERENCES public.teams(team_id),
  CONSTRAINT game_player_stats_team_id_league_id_fkey FOREIGN KEY (team_id) REFERENCES public.teams(team_id),
  CONSTRAINT game_player_stats_team_id_league_id_fkey FOREIGN KEY (league_id) REFERENCES public.teams(league_id),
  CONSTRAINT game_player_stats_team_id_league_id_fkey FOREIGN KEY (team_id) REFERENCES public.teams(league_id)
);
CREATE TABLE public.game_quarters (
  game_id text NOT NULL,
  team_id integer NOT NULL,
  league_id integer NOT NULL,
  quarter integer NOT NULL CHECK (quarter >= 1 AND quarter <= 4),
  team text,
  opponent text,
  opponent_id integer,
  game_date date,
  score integer,
  score_against integer,
  created_at timestamp with time zone DEFAULT now(),
  updated_at timestamp with time zone DEFAULT now(),
  CONSTRAINT game_quarters_pkey PRIMARY KEY (game_id, team_id, quarter),
  CONSTRAINT game_quarters_game_id_fkey FOREIGN KEY (game_id) REFERENCES public.games(game_id),
  CONSTRAINT game_quarters_league_id_fkey FOREIGN KEY (league_id) REFERENCES public.leagues(league_id),
  CONSTRAINT game_quarters_team_id_league_id_fkey FOREIGN KEY (team_id) REFERENCES public.teams(team_id),
  CONSTRAINT game_quarters_team_id_league_id_fkey FOREIGN KEY (league_id) REFERENCES public.teams(team_id),
  CONSTRAINT game_quarters_team_id_league_id_fkey FOREIGN KEY (team_id) REFERENCES public.teams(league_id),
  CONSTRAINT game_quarters_team_id_league_id_fkey FOREIGN KEY (league_id) REFERENCES public.teams(league_id),
  CONSTRAINT game_quarters_opponent_id_league_id_fkey FOREIGN KEY (league_id) REFERENCES public.teams(team_id),
  CONSTRAINT game_quarters_opponent_id_league_id_fkey FOREIGN KEY (opponent_id) REFERENCES public.teams(team_id),
  CONSTRAINT game_quarters_opponent_id_league_id_fkey FOREIGN KEY (league_id) REFERENCES public.teams(league_id),
  CONSTRAINT game_quarters_opponent_id_league_id_fkey FOREIGN KEY (opponent_id) REFERENCES public.teams(league_id)
);
CREATE TABLE public.game_team_stats (
  game_id text NOT NULL,
  team_id integer NOT NULL,
  league_id integer NOT NULL,
  team text,
  opponent text,
  opponent_id integer,
  game_date date,
  pts integer,
  fgm integer,
  fga integer,
  fg_pct numeric,
  2ptm integer,
  2pta integer,
  2pt_pct numeric,
  3ptm integer,
  3pta integer,
  3pt_pct numeric,
  ftm integer,
  fta integer,
  ft_pct numeric,
  def integer,
  off integer,
  reb integer,
  ast integer,
  stl integer,
  to integer,
  pf integer,
  pfa integer,
  blk integer,
  blka integer,
  rate numeric,
  second_chance_pts integer,
  bench_pts integer,
  fast_break_pts integer,
  points_in_paint integer,
  pts_off_turnovers integer,
  starters_pts integer,
  created_at timestamp with time zone DEFAULT now(),
  updated_at timestamp with time zone DEFAULT now(),
  CONSTRAINT game_team_stats_pkey PRIMARY KEY (game_id, team_id),
  CONSTRAINT game_team_stats_game_id_fkey FOREIGN KEY (game_id) REFERENCES public.games(game_id),
  CONSTRAINT game_team_stats_league_id_fkey FOREIGN KEY (league_id) REFERENCES public.leagues(league_id),
  CONSTRAINT game_team_stats_team_id_league_id_fkey FOREIGN KEY (team_id) REFERENCES public.teams(team_id),
  CONSTRAINT game_team_stats_team_id_league_id_fkey FOREIGN KEY (league_id) REFERENCES public.teams(team_id),
  CONSTRAINT game_team_stats_team_id_league_id_fkey FOREIGN KEY (team_id) REFERENCES public.teams(league_id),
  CONSTRAINT game_team_stats_team_id_league_id_fkey FOREIGN KEY (league_id) REFERENCES public.teams(league_id),
  CONSTRAINT game_team_stats_opponent_id_league_id_fkey FOREIGN KEY (league_id) REFERENCES public.teams(team_id),
  CONSTRAINT game_team_stats_opponent_id_league_id_fkey FOREIGN KEY (opponent_id) REFERENCES public.teams(team_id),
  CONSTRAINT game_team_stats_opponent_id_league_id_fkey FOREIGN KEY (league_id) REFERENCES public.teams(league_id),
  CONSTRAINT game_team_stats_opponent_id_league_id_fkey FOREIGN KEY (opponent_id) REFERENCES public.teams(league_id)
);
CREATE TABLE public.games (
  game_id text NOT NULL,
  league_id integer NOT NULL,
  season text,
  code text,
  date date NOT NULL,
  time text,
  round integer,
  home_team text NOT NULL,
  home_team_id integer,
  away_team text NOT NULL,
  away_team_id integer,
  venue text,
  home_score integer,
  away_score integer,
  status text DEFAULT 'scheduled'::text,
  overtimes integer DEFAULT 0,
  close_game boolean DEFAULT false,
  winner text,
  loser text,
  created_at timestamp with time zone DEFAULT now(),
  updated_at timestamp with time zone DEFAULT now(),
  CONSTRAINT games_pkey PRIMARY KEY (game_id),
  CONSTRAINT games_league_id_fkey FOREIGN KEY (league_id) REFERENCES public.leagues(league_id),
  CONSTRAINT games_home_team_id_league_id_fkey FOREIGN KEY (league_id) REFERENCES public.teams(team_id),
  CONSTRAINT games_home_team_id_league_id_fkey FOREIGN KEY (home_team_id) REFERENCES public.teams(team_id),
  CONSTRAINT games_home_team_id_league_id_fkey FOREIGN KEY (league_id) REFERENCES public.teams(league_id),
  CONSTRAINT games_home_team_id_league_id_fkey FOREIGN KEY (home_team_id) REFERENCES public.teams(league_id),
  CONSTRAINT games_away_team_id_league_id_fkey FOREIGN KEY (league_id) REFERENCES public.teams(team_id),
  CONSTRAINT games_away_team_id_league_id_fkey FOREIGN KEY (away_team_id) REFERENCES public.teams(team_id),
  CONSTRAINT games_away_team_id_league_id_fkey FOREIGN KEY (league_id) REFERENCES public.teams(league_id),
  CONSTRAINT games_away_team_id_league_id_fkey FOREIGN KEY (away_team_id) REFERENCES public.teams(league_id)
);
CREATE TABLE public.leagues (
  league_id integer NOT NULL,
  name text NOT NULL,
  name_en text,
  country text,
  season text,
  url text,
  is_active boolean DEFAULT false,
  created_at timestamp with time zone DEFAULT now(),
  updated_at timestamp with time zone DEFAULT now(),
  CONSTRAINT leagues_pkey PRIMARY KEY (league_id)
);
CREATE TABLE public.opponent_averages (
  team_id integer NOT NULL,
  league_id integer NOT NULL,
  team text,
  games_played integer,
  opp_pts numeric,
  opp_pts_rank integer,
  opp_fgm numeric,
  opp_fga numeric,
  opp_fg_pct numeric,
  opp_fg_pct_rank integer,
  opp_2ptm numeric,
  opp_2pta numeric,
  opp_2pt_pct numeric,
  opp_2pt_pct_rank integer,
  opp_3ptm numeric,
  opp_3pta numeric,
  opp_3pt_pct numeric,
  opp_3pt_pct_rank integer,
  opp_ftm numeric,
  opp_fta numeric,
  opp_ft_pct numeric,
  opp_ft_pct_rank integer,
  opp_def numeric,
  opp_def_rank integer,
  opp_off numeric,
  opp_off_rank integer,
  opp_reb numeric,
  opp_reb_rank integer,
  opp_ast numeric,
  opp_ast_rank integer,
  opp_stl numeric,
  opp_stl_rank integer,
  opp_to numeric,
  opp_to_rank integer,
  opp_pf numeric,
  opp_pf_rank integer,
  opp_blk numeric,
  opp_blk_rank integer,
  opp_blka numeric,
  opp_blka_rank integer,
  opp_rate numeric,
  opp_rate_rank integer,
  opp_second_chance_pts numeric,
  opp_fast_break_pts numeric,
  opp_points_in_paint numeric,
  opp_pts_off_turnovers numeric,
  opp_possessions numeric,
  created_at timestamp with time zone DEFAULT now(),
  updated_at timestamp with time zone DEFAULT now(),
  CONSTRAINT opponent_averages_pkey PRIMARY KEY (team_id, league_id),
  CONSTRAINT opponent_averages_league_id_fkey FOREIGN KEY (league_id) REFERENCES public.leagues(league_id),
  CONSTRAINT opponent_averages_team_id_league_id_fkey FOREIGN KEY (team_id) REFERENCES public.teams(team_id),
  CONSTRAINT opponent_averages_team_id_league_id_fkey FOREIGN KEY (league_id) REFERENCES public.teams(team_id),
  CONSTRAINT opponent_averages_team_id_league_id_fkey FOREIGN KEY (team_id) REFERENCES public.teams(league_id),
  CONSTRAINT opponent_averages_team_id_league_id_fkey FOREIGN KEY (league_id) REFERENCES public.teams(league_id)
);
CREATE TABLE public.player_averages (
  player_id text NOT NULL,
  league_id integer NOT NULL,
  player_name text,
  team text,
  team_id integer,
  games_played integer,
  games_started integer,
  min numeric,
  pts numeric,
  fgm numeric,
  fga numeric,
  fg_pct numeric,
  2ptm numeric,
  2pta numeric,
  2pt_pct numeric,
  3ptm numeric,
  3pta numeric,
  3pt_pct numeric,
  ftm numeric,
  fta numeric,
  ft_pct numeric,
  def numeric,
  off numeric,
  reb numeric,
  ast numeric,
  stl numeric,
  to numeric,
  pf numeric,
  pfa numeric,
  blk numeric,
  blka numeric,
  rate numeric,
  pts_rank integer,
  reb_rank integer,
  ast_rank integer,
  stl_rank integer,
  blk_rank integer,
  fg_pct_rank integer,
  3pt_pct_rank integer,
  ft_pct_rank integer,
  created_at timestamp with time zone DEFAULT now(),
  updated_at timestamp with time zone DEFAULT now(),
  CONSTRAINT player_averages_pkey PRIMARY KEY (player_id, league_id),
  CONSTRAINT player_averages_player_id_fkey FOREIGN KEY (player_id) REFERENCES public.players(player_id),
  CONSTRAINT player_averages_league_id_fkey FOREIGN KEY (league_id) REFERENCES public.leagues(league_id),
  CONSTRAINT player_averages_team_id_league_id_fkey FOREIGN KEY (league_id) REFERENCES public.teams(team_id),
  CONSTRAINT player_averages_team_id_league_id_fkey FOREIGN KEY (team_id) REFERENCES public.teams(team_id),
  CONSTRAINT player_averages_team_id_league_id_fkey FOREIGN KEY (league_id) REFERENCES public.teams(league_id),
  CONSTRAINT player_averages_team_id_league_id_fkey FOREIGN KEY (team_id) REFERENCES public.teams(league_id)
);
CREATE TABLE public.player_season_history (
  player_id text NOT NULL,
  season text NOT NULL,
  team_name text,
  league_name text,
  league_id integer,
  created_at timestamp with time zone DEFAULT now(),
  updated_at timestamp with time zone DEFAULT now(),
  CONSTRAINT player_season_history_pkey PRIMARY KEY (player_id, season),
  CONSTRAINT player_season_history_player_id_fkey FOREIGN KEY (player_id) REFERENCES public.players(player_id),
  CONSTRAINT player_season_history_league_id_fkey FOREIGN KEY (league_id) REFERENCES public.leagues(league_id)
);
CREATE TABLE public.players (
  player_id text NOT NULL,
  name text NOT NULL,
  current_team_id integer,
  league_id integer NOT NULL,
  date_of_birth date,
  height numeric,
  jersey_number integer,
  ibba_url text,
  created_at timestamp with time zone DEFAULT now(),
  updated_at timestamp with time zone DEFAULT now(),
  CONSTRAINT players_pkey PRIMARY KEY (player_id),
  CONSTRAINT players_league_id_fkey FOREIGN KEY (league_id) REFERENCES public.leagues(league_id),
  CONSTRAINT players_current_team_id_league_id_fkey FOREIGN KEY (current_team_id) REFERENCES public.teams(team_id),
  CONSTRAINT players_current_team_id_league_id_fkey FOREIGN KEY (league_id) REFERENCES public.teams(team_id),
  CONSTRAINT players_current_team_id_league_id_fkey FOREIGN KEY (current_team_id) REFERENCES public.teams(league_id),
  CONSTRAINT players_current_team_id_league_id_fkey FOREIGN KEY (league_id) REFERENCES public.teams(league_id)
);
CREATE TABLE public.team_averages (
  team_id integer NOT NULL,
  league_id integer NOT NULL,
  team text,
  games_played integer,
  pts numeric,
  pts_rank integer,
  pts_allowed numeric,
  pts_allowed_rank integer,
  fgm numeric,
  fga numeric,
  fg_pct numeric,
  fg_pct_rank integer,
  2ptm numeric,
  2pta numeric,
  2pt_pct numeric,
  2pt_pct_rank integer,
  3ptm numeric,
  3pta numeric,
  3pt_pct numeric,
  3pt_pct_rank integer,
  ftm numeric,
  fta numeric,
  ft_pct numeric,
  ft_pct_rank integer,
  def numeric,
  def_rank integer,
  off numeric,
  off_rank integer,
  reb numeric,
  reb_rank integer,
  ast numeric,
  ast_rank integer,
  stl numeric,
  stl_rank integer,
  to numeric,
  to_rank integer,
  pf numeric,
  pf_rank integer,
  pfa numeric,
  pfa_rank integer,
  blk numeric,
  blk_rank integer,
  blka numeric,
  blka_rank integer,
  rate numeric,
  rate_rank integer,
  second_chance_pts numeric,
  bench_pts numeric,
  fast_break_pts numeric,
  points_in_paint numeric,
  pts_off_turnovers numeric,
  possessions numeric,
  created_at timestamp with time zone DEFAULT now(),
  updated_at timestamp with time zone DEFAULT now(),
  CONSTRAINT team_averages_pkey PRIMARY KEY (team_id, league_id),
  CONSTRAINT team_averages_league_id_fkey FOREIGN KEY (league_id) REFERENCES public.leagues(league_id),
  CONSTRAINT team_averages_team_id_league_id_fkey FOREIGN KEY (team_id) REFERENCES public.teams(team_id),
  CONSTRAINT team_averages_team_id_league_id_fkey FOREIGN KEY (league_id) REFERENCES public.teams(team_id),
  CONSTRAINT team_averages_team_id_league_id_fkey FOREIGN KEY (team_id) REFERENCES public.teams(league_id),
  CONSTRAINT team_averages_team_id_league_id_fkey FOREIGN KEY (league_id) REFERENCES public.teams(league_id)
);
CREATE TABLE public.teams (
  team_id integer NOT NULL,
  league_id integer NOT NULL,
  team_name text NOT NULL,
  short_name text,
  bg_color text DEFAULT '#000000'::text,
  text_color text DEFAULT '#FFFFFF'::text,
  name_variations text,
  created_at timestamp with time zone DEFAULT now(),
  updated_at timestamp with time zone DEFAULT now(),
  club_id integer,
  facebook text,
  instagram text,
  logo_url text,
  CONSTRAINT teams_pkey PRIMARY KEY (team_id, league_id),
  CONSTRAINT teams_league_id_fkey FOREIGN KEY (league_id) REFERENCES public.leagues(league_id)
);